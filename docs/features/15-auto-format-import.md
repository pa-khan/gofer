# 15. Auto Format & Auto Import

## –ö–∞—Ç–µ–≥–æ—Ä–∏—è
IDE-like –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (Code Quality Tools)

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
üî• **P0** (–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production-ready –∫–æ–¥–∞)

## –û—Ü–µ–Ω–∫–∞ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ –¥–ª—è AI
‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

## –û–ø–∏—Å–∞–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤.

## –ü—Ä–æ–±–ª–µ–º–∞
AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥, –Ω–æ –æ–Ω "–Ω–µ–∫—Ä–∞—Å–∏–≤—ã–π": –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º–ø–æ—Ä—Ç—ã, –Ω–∞—Ä—É—à–µ–Ω–∏—è style guide. AI –¥–æ–ª–∂–µ–Ω –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–æ–¥ —Å—Ä–∞–∑—É (—á—Ç–æ —Å–ª–æ–∂–Ω–æ).

## API

### format_file(path, formatter)
–ê–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (string) ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `formatter` (string, optional) ‚Äî –∫–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é)

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã:**
- Rust: `rustfmt`
- TypeScript/JavaScript: `prettier`, `biome`
- Python: `black`, `ruff format`
- Go: `gofmt`
- JSON: `jq`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```json
{
  "path": "src/auth.rs",
  "status": "formatted",
  "formatter": "rustfmt",
  "changes_made": true,
  "diff_lines": 12
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
AI: patch_file("src/auth.rs", ...)  # AI –Ω–∞–ø–∏—Å–∞–ª –∫–æ–¥
AI: format_file("src/auth.rs")     # MCP –ø—Ä–∏—á—ë—Å—ã–≤–∞–µ—Ç –µ–≥–æ
Result: –∫–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ rustfmt
```

---

### auto_import(path, symbol)
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (string) ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `symbol` (string) ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Å–∏–º–≤–æ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `HashMap`, `useEffect`)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```json
{
  "path": "src/utils.rs",
  "status": "import_added",
  "import_line": "use std::collections::HashMap;",
  "inserted_at_line": 3
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**

#### Rust
```
AI: patch_file("src/utils.rs", ..., replace="let map = HashMap::new();")
AI: auto_import("src/utils.rs", "HashMap")
Result: –¥–æ–±–∞–≤–ª–µ–Ω–æ "use std::collections::HashMap;" –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞
```

#### TypeScript
```
AI: patch_file("App.tsx", ..., replace="const [state, setState] = useState(0);")
AI: auto_import("App.tsx", "useState")
Result: –¥–æ–±–∞–≤–ª–µ–Ω–æ "import { useState } from 'react';" –≤ –Ω–∞—á–∞–ª–æ
```

---

### lint_file(path)
–ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä –∏ –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è/–æ—à–∏–±–∫–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (string) ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```json
{
  "path": "src/auth.rs",
  "linter": "clippy",
  "warnings": [
    {
      "line": 42,
      "column": 10,
      "severity": "warning",
      "message": "unused variable: `token`",
      "code": "unused_variables",
      "fix_available": true,
      "fix_id": "fix_001"
    }
  ],
  "errors": []
}
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ª–∏–Ω—Ç–µ—Ä—ã:**
- Rust: `clippy`
- TypeScript: `eslint`, `biome`
- Python: `ruff`, `pylint`, `flake8`
- Go: `golangci-lint`

---

### apply_lint_fix(path, fix_id)
–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –ª–∏–Ω—Ç–µ—Ä–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (string) ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `fix_id` (string, optional) ‚Äî ID –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∏–∫—Å–∞ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ‚Äî –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```json
{
  "path": "src/auth.rs",
  "status": "fixed",
  "fixes_applied": 3,
  "remaining_warnings": 1
}
```

**–ü—Ä–∏–º–µ—Ä workflow:**
```
AI: patch_file("src/auth.rs", ...)
AI: lint_file("src/auth.rs")
Result: 3 warnings with auto-fixes available

AI: apply_lint_fix("src/auth.rs")  # –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ —Ñ–∏–∫—Å—ã
Result: 3 warnings –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: AI –ø–∏—à–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
```
1. AI: patch_file("src/api.rs", search="// TODO", replace="fn process() { let map = HashMap::new(); }")
2. AI: auto_import("src/api.rs", "HashMap")
3. AI: format_file("src/api.rs")
4. AI: lint_file("src/api.rs")
5. AI: apply_lint_fix("src/api.rs")  # –µ—Å–ª–∏ –µ—Å—Ç—å –∞–≤—Ç–æ—Ñ–∏–∫—Å—ã

Result: –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω, –∏–º–ø–æ—Ä—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã, –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω, lint warnings –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
```

### –°—Ü–µ–Ω–∞—Ä–∏–π: AI —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–¥
```
1. AI: patch_file("src/legacy.rs", ...)  # –±–æ–ª—å—à–æ–π –ø–∞—Ç—á
2. AI: format_file("src/legacy.rs")      # –ø—Ä–∏—á–µ—Å–∞—Ç—å –∫–æ–¥
3. AI: lint_file("src/legacy.rs")
   Result: 10 warnings

4. AI: apply_lint_fix("src/legacy.rs")   # –∞–≤—Ç–æ—Ñ–∏–∫—Å—ã
5. AI: lint_file("src/legacy.rs")
   Result: 2 warnings (–Ω–µ –∞–≤—Ç–æ—Ñ–∏–∫—Å–∏–º—ã–µ)

6. AI: (–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è warnings –∏ —Ñ–∏–∫—Å–∏—Ç –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ patch_file)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. Production-ready –∫–æ–¥
AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–∑—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç style guide –ø—Ä–æ–µ–∫—Ç–∞.

### 2. –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤
AI –Ω–µ —Ç—Ä–∞—Ç–∏—Ç —Ç–æ–∫–µ–Ω—ã –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–¥–µ–∞–ª—å–Ω—ã—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –∏ –∏–º–ø–æ—Ä—Ç–æ–≤ ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç MCP.

### 3. –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥.

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–ú–Ω–æ–≥–∏–µ lint warnings —Ñ–∏–∫—Å—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, AI –Ω–µ –Ω—É–∂–Ω–æ –∏—Ö –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.

## –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–ù–∏–∑–∫–∞—è (2-3 –¥–Ω—è)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞–º–∏: –æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è (–≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö –∫–æ–º–∞–Ω–¥)
- Auto-import: —Å—Ä–µ–¥–Ω—è—è (—Ç—Ä–µ–±—É–µ—Ç LSP –∏–ª–∏ AST-–∞–Ω–∞–ª–∏–∑–∞)
- Lint integration: –Ω–∏–∑–∫–∞—è (–ø–∞—Ä—Å–∏–Ω–≥ –≤—ã–≤–æ–¥–∞ –ª–∏–Ω—Ç–µ—Ä–æ–≤)

## –°—Ç–∞—Ç—É—Å –≤ gofer
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ –µ—Å—Ç—å `run_diagnostics` (—á–∞—Å—Ç–∏—á–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ lint)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –í–Ω–µ—à–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã (rustfmt, prettier, black, –∏ —Ç.–¥.)
- LSP –¥–ª—è auto-import (–∏–ª–∏ Tree-sitter –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤)
- –õ–∏–Ω—Ç–µ—Ä—ã (clippy, eslint, ruff, –∏ —Ç.–¥.)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```toml
[code_quality]
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π format –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ patch_file
auto_format = true

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π auto_import –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
auto_import = true

# –ó–∞–ø—É—Å–∫–∞—Ç—å lint –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
auto_lint = false

# –ü—Ä–∏–º–µ–Ω—è—Ç—å lint fixes –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
auto_apply_fixes = false

# –§–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã –ø–æ —è–∑—ã–∫–∞–º
[code_quality.formatters]
rust = "rustfmt"
typescript = "prettier"
javascript = "prettier"
python = "black"
go = "gofmt"

# –õ–∏–Ω—Ç–µ—Ä—ã –ø–æ —è–∑—ã–∫–∞–º
[code_quality.linters]
rust = "clippy"
typescript = "eslint"
python = "ruff"
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–æ–¥ —Å—Ä–∞–∑—É (—Å–ª–æ–∂–Ω–æ, —Ç—Ä–∞—Ç–∏—Ç —Ç–æ–∫–µ–Ω—ã)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã (–Ω–µ—É–¥–æ–±–Ω–æ)
- Pre-commit hooks (—Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ)

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `patch_file` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ (–ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
- `verify_patch` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- `run_diagnostics` ‚Äî –ø–æ—Ö–æ–∂–µ –Ω–∞ lint
