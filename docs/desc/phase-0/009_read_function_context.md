# Feature: read_function_context - ะงัะตะฝะธะต ััะฝะบัะธะธ ั ะทะฐะฒะธัะธะผะพัััะผะธ

**ID:** PHASE0-009  
**Priority:** ๐ฅ๐ฅ๐ฅ High  
**Effort:** 2 ะดะฝั  
**Status:** Not Started  
**Phase:** 0 (Token-Efficient Reading)

---

## ๐ ะะฟะธัะฐะฝะธะต

MCP tool ะดะปั ะธะทะฒะปะตัะตะฝะธั ะบะพะดะฐ ะพะดะฝะพะน ััะฝะบัะธะธ ะฒะผะตััะต ั ะตั ะฝะตะฟะพััะตะดััะฒะตะฝะฝัะผะธ ะทะฐะฒะธัะธะผะพัััะผะธ (ะธะผะฟะพััั, ัะธะฟั, ะดััะณะธะต ััะฝะบัะธะธ). ะญะบะพะฝะพะผะธั ัะพะบะตะฝั, ะฟัะตะดะพััะฐะฒะปัั ัะพะปัะบะพ ัะตะปะตะฒะฐะฝัะฝัะน ะบะพะฝัะตะบัั ะฒะผะตััะพ ััะตะฝะธั ะฒัะตะณะพ ัะฐะนะปะฐ.

### ะัะพะฑะปะตะผะฐ

**ะขะตะบััะธะน ะฟะพะดัะพะด:**
```
AI: "ะะพะบะฐะถะธ ััะฝะบัะธั handle_request ะธะท server.rs"

ะะฐะทัะฐะฑะพััะธะบ ะธัะฟะพะปัะทัะตั read_file("server.rs"):
- ะคะฐะนะป: 2000 ัััะพะบ
- ะคัะฝะบัะธั: 50 ัััะพะบ
- Waste: 1950 ัััะพะบ ะฝะตะฝัะถะฝะพะณะพ ะบะพะดะฐ
- Tokens: ~4000 ัะพะบะตะฝะพะฒ

ะะฐัะตะผ AI ัะธัะฐะตั imports ะฒัััะฝัั:
- read_file("http.rs") - ะตัะต 1500 ัััะพะบ
- read_file("auth.rs") - ะตัะต 1200 ัััะพะบ
Total: 4700 ัััะพะบ, ~10000 ัะพะบะตะฝะพะฒ
```

**ะัะพะฑะปะตะผั:**
- 95% ัะพะบะตะฝะพะฒ ััะฐัะธััั ะฝะฐ ะฝะตัะตะปะตะฒะฐะฝัะฝัะน ะบะพะด
- AI ะฒัะฝัะถะดะตะฝ ัะธัะฐัั ะฒะตัั ัะฐะนะป, ััะพะฑั ะฝะฐะนัะธ ะพะดะฝั ััะฝะบัะธั
- ะะฐัะตะผ ะฒัััะฝัั ะธัะบะฐัั ะทะฐะฒะธัะธะผะพััะธ
- Multiple round-trips (ะผะตะดะปะตะฝะฝะพ)

### ะะตัะตะฝะธะต

**ะก read_function_context:**
```
AI: read_function_context("server.rs", "handle_request")

ะะตะทัะปััะฐั:
- ะคัะฝะบัะธั handle_request: 50 ัััะพะบ
- ะัะฟะพะปัะทัะตะผัะต imports: 10 ัััะพะบ
- ะขะธะฟั Request/Response: 30 ัััะพะบ
- ะัะทะฒะฐะฝะฝัะต ััะฝะบัะธะธ: authenticate, validate: 40 ัััะพะบ
Total: 130 ัััะพะบ, ~300 ัะพะบะตะฝะพะฒ

ะญะบะพะฝะพะผะธั: 97% ัะพะบะตะฝะพะฒ! (10000 โ 300)
Round-trips: 1 ะฒะผะตััะพ 4
```

---

## ๐ฏ Goals & Non-Goals

### Goals
- โ ะะทะฒะปะตัั ะพะดะฝั ััะฝะบัะธั ั ะผะธะฝะธะผะฐะปัะฝัะผ ะบะพะฝัะตะบััะพะผ
- โ ะะบะปััะธัั ัะพะปัะบะพ ะธัะฟะพะปัะทัะตะผัะต ะธะผะฟะพััั
- โ ะะบะปััะธัั ะพะฟัะตะดะตะปะตะฝะธั ัะธะฟะพะฒ, ะฝะฐ ะบะพัะพััะต ัััะปะฐะตััั ััะฝะบัะธั
- โ ะะฟัะธะพะฝะฐะปัะฝะพ ะฒะบะปััะธัั ะฒัะทัะฒะฐะตะผัะต ััะฝะบัะธะธ (callees)
- โ 90-95% ัะบะพะฝะพะผะธั ัะพะบะตะฝะพะฒ vs ะฟะพะปะฝัะน read_file
- โ ะะดะธะฝ ะทะฐะฟัะพั ะฒะผะตััะพ ะฝะตัะบะพะปัะบะธั

### Non-Goals
- โ ะะต ะฒะบะปััะฐะตั ะฒะตัั call graph (ััะพ ะดะตะปะฐะตั get_callees)
- โ ะะต ัะตะบัััะธะฒะฝัะน ะพะฑัะพะด ะทะฐะฒะธัะธะผะพััะตะน (ัะพะปัะบะพ 1 ััะพะฒะตะฝั)
- โ ะะต ัััะพะธั ะฟะพะปะฝัะน dependency tree
- โ ะะต ะฐะฝะฐะปะธะทะธััะตั runtime ะฟะพะฒะตะดะตะฝะธะต

---

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะะพะผะฟะพะฝะตะฝัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         MCP Tool Handler                โ
โ    read_function_context()              โ
โโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโ
                 โ
        โโโโโโโโโโผโโโโโโโโโ
        โ   Function      โ
        โ   Extractor     โ
        โโโโโโโโโโฌโโโโโโโโโ
                 โ
     โโโโโโโโโโโโโผโโโโโโโโโโโโฌโโโโโโโโโโโโโ
     โ           โ           โ            โ
โโโโโโผโโโโโโ โโโโผโโโโ โโโโโโผโโโโโโโ โโโโโผโโโโโ
โ   AST    โ โImportโ โ   Type    โ โ Callee โ
โ Parser   โ โFinderโ โ  Resolver โ โ Finder โ
โโโโโโโโโโโโ โโโโโโโโ โโโโโโโโโโโโโ โโโโโโโโโโ
```

### ะัะพัะตัั ะธะทะฒะปะตัะตะฝะธั

```
1. Locate function ะฒ AST
   โ
2. Extract function body
   โ
3. Find ะธัะฟะพะปัะทัะตะผัะต imports
   โโโ Parse use statements
   โโโ ะกะพะฟะพััะฐะฒะธัั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฒ ะบะพะดะต
   โ
4. Find ะธัะฟะพะปัะทัะตะผัะต types
   โโโ ะะฐะนัะธ ะฒัะต type references ะฒ function
   โโโ Resolve definitions
   โโโ Extract type definitions
   โ
5. Find callees (if include_callees=true)
   โโโ ะะฐะนัะธ ะฒัะต function calls
   โโโ Resolve definitions
   โโโ Extract callee functions
   โ
6. Assemble context
   โโโ Format as readable code
```

---

## ๐ Data Model

### MCP Tool Definition

```json
{
  "name": "read_function_context",
  "description": "ะะทะฒะปะตัั ะพะดะฝั ััะฝะบัะธั ั ะตั ะทะฐะฒะธัะธะผะพัััะผะธ (imports, types, ะฒัะทัะฒะฐะตะผัะต ััะฝะบัะธะธ). ะญะบะพะฝะพะผะธั 90-95% ัะพะบะตะฝะพะฒ vs read_file.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "file": {
        "type": "string",
        "description": "ะััั ะบ ัะฐะนะปั"
      },
      "function": {
        "type": "string",
        "description": "ะะผั ััะฝะบัะธะธ"
      },
      "include_types": {
        "type": "boolean",
        "default": true,
        "description": "ะะบะปััะธัั ะพะฟัะตะดะตะปะตะฝะธั ัะธะฟะพะฒ"
      },
      "include_imports": {
        "type": "boolean",
        "default": true,
        "description": "ะะบะปััะธัั ะธะผะฟะพััั"
      },
      "include_callees": {
        "type": "boolean",
        "default": false,
        "description": "ะะบะปััะธัั ะฒัะทัะฒะฐะตะผัะต ััะฝะบัะธะธ (1 ััะพะฒะตะฝั)"
      }
    },
    "required": ["file", "function"]
  }
}
```

---

## ๐ป Implementation Details

ะัะฟะพะปัะทัะตั tree-sitter ะดะปั AST parsing, SQLite ะธะฝะดะตะบั ะดะปั resolution ัะธะฟะพะฒ ะธ ััะฝะบัะธะน.

---

## ๐ Success Metrics

- โก 90-95% ัะบะพะฝะพะผะธั ัะพะบะตะฝะพะฒ vs read_file
- โ 100% ะธัะฟะพะปัะทัะตะผัั imports
- โฑ๏ธ Response time: < 1s

---

## โ Acceptance Criteria

- [ ] Correctly locates function
- [ ] Filters only used imports
- [ ] Resolves type definitions
- [ ] Optionally includes callees
- [ ] 90%+ token savings
- [ ] All tests pass

---

**Status:** Ready for implementation  
**Last Updated:** 2026-02-16  
**Assigned To:** TBD
